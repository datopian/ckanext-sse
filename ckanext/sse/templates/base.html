{% ckan_extends %} 

{% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const modal = document.getElementById("custom-modal");
        const modalCloseBtn = document.getElementById("modal-close-btn");
        const modalConfirmBtn = document.getElementById("modal-confirm-btn");
        const modalTriggerBtns = document.querySelectorAll("[data-trigger='modal']");

        let triggerButtonName = ""; // Store the name of the trigger button
        let triggerButtonValue = ""; // Store the value of the trigger button

        const openModal = (button) => {
            triggerButtonName = button.getAttribute("name") || "Unnamed Button";
            triggerButtonValue = button.value || "No Value";
            const formSubmitButton = document.createElement('button');
            formSubmitButton.style.display = 'none';
            formSubmitButton.type = 'submit';
            formSubmitButton.setAttribute('name', triggerButtonName)
            formSubmitButton.setAttribute('value', triggerButtonValue)

            button.parentNode.insertBefore(formSubmitButton, button.nextSibling);

            const modalConfirmButton = document.getElementById("modal-confirm-btn");
            modalConfirmBtn.onclick = () => formSubmitButton.click()
            modal.style.display = "block";
        };

        // Function to close the modal
        const closeModal = () => {
            modal.style.display = "none";
        };

        // Add event listener to close button
        if (modalCloseBtn) {
            modalCloseBtn.addEventListener("click", closeModal);
        }

        // Add event listener to confirm button
        if (modalConfirmBtn) {
            modalConfirmBtn.addEventListener("click", () => {
                closeModal();
            });
        }

        // Add event listeners to trigger buttons
        modalTriggerBtns.forEach((btn) => {
            btn.addEventListener("click", () => openModal(btn));
        });

        // Close modal when clicking outside of it
        window.addEventListener("click", (event) => {
            if (event.target === modal) {
                closeModal();
            }
        });
    });
</script>
{% endblock %}

