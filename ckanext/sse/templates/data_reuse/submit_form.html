{% extends "page.html" %}
{% import 'macros/form.html' as form %}

{% block subtitle %}{{ _('Submit Data Usage Form') }} - {{ package.title or package.name }}{% endblock %}

{% block breadcrumb_content %}
<li>{{ h.nav_link(_('Datasets'), named_route='dataset.search') }}</li>
<li>{{ h.nav_link(package.title or package.name, named_route='dataset.read', id=package.name) }}</li>
<li class="active">{{ _('Submit Reuse ') }}</li>
{% endblock %}

{% block primary_content %}
{% set field_labels = h.get_data_reuse_field_labels() %}
<article class="module">
  <div class="module-content">
    <h1 class="page-heading">
    {% block page_heading %}{{ _('Share a Reuse Idea or Example of Usage') }}{% endblock %}
    </h1>

    <div class="alert alert-info">
      <p>{{ _('Share how you have used or plan to use this dataset. Your contribution helps others understand the value
        and potential applications of this data.') }}</p>
    </div>

    <form method="post" action="{{ h.url_for('data_reuse.submit_form', package_id=package.id) }}"
      class="form-horizontal needs-validation" data-module="data-reuse-form" novalidate>
      <div class="form-section">

        <!-- Required Fields Section -->

        <!-- Full Name -->
        {{ form.input('full_name', id='full_name',
        label=field_labels.full_name, placeholder=_('Enter your full name'),
        value=data.full_name, error=errors.full_name, classes=['control-full'], attrs={ 'class': 'form-control'}) }}

        <!-- Organisation Name -->
        {{ form.input('organisation_name', id='organisation_name',
        label=field_labels.organisation_name,
        placeholder=_('Enter your organisation name'), value=data.organisation_name, error=errors.organisation_name,
        classes=['control-full'],
        attrs={ 'class': 'form-control'}) }}

        <!-- Job Title -->
        {{ form.input('job_title', id='job_title', label=field_labels.job_title,
        placeholder=_('Enter your job title'),
        value=data.job_title, error=errors.job_title, classes=['control-full'], attrs={'class': 'form-control'} ) }}

        <!-- Email Address -->
        {{ form.input('email_address', id='email_address',
        label=field_labels.email_address,
        placeholder=_('Enter your email address'), value=data.email_address, error=errors.email_address,
        classes=['control-full'], attrs={'required':
        'required', 'type': 'email', 'class': 'form-control'}) }}
        <div class="invalid-feedback">
          {{ _('Please provide a valid email address.') }}
        </div>

        <!-- Title -->
        {{ form.input('title', id='title', label=field_labels.title,
        placeholder=_('Brief title describing your usage or idea'),
        value=data.title, error=errors.title, classes=['control-full'], attrs={'required': 'required', 'class':
        'form-control'}) }}
        <div class="invalid-feedback">
          {{ _('Please provide a title.') }}
        </div>

        <!-- Label -->
        {{ form.select('label', id='label', label=field_labels.label, options=label_choices, selected=data.label,
        error=errors.label, classes=['control-full'], attrs={'required': 'required', 'class': 'form-control'}) }}
        <div class="invalid-feedback">
          {{ _('Please select a category.') }}
        </div>

        <!-- Organisation Type -->
        {{ form.select('organisation_type', id='organisation_type', label=field_labels.organisation_type,
        options=organisation_type_choices, selected=data.organisation_type, error=errors.organisation_type,
        classes=['control-full'], attrs={'required': 'required', 'class': 'form-control'}) }}
        <div class="invalid-feedback">
          {{ _('Please select an organisation type.') }}
        </div>

        <!-- Submission Type -->
        {%- call
        form.select('submission_type', id='submission_type',
        label=field_labels.submission_type,
        options=submission_type_choices, selected=data.submission_type, error=errors.submission_type,
        classes=['control-full'], attrs={'required': 'required', 'class': 'form-control'})
        -%}
        {{ form.info(_('Choose "Example" if you have used this data, or "Idea" if you have a suggestion for its use'))
        }}

        {%- endcall %}
        <div class="invalid-feedback">
          {{ _('Please select a submission type.') }}
        </div>

        <!-- Usage Example - shown for "Example" type -->
        <div id="usage_example_field">
          {{ form.textarea('usage_example', id='usage_example', label=field_labels.usage_example,
          placeholder=_('Describe how you have used this dataset...'), value=data.usage_example,
          error=errors.usage_example,
          attrs={'class': 'form-control'}, classes=['control-full']) }}
          <div class="invalid-feedback">
            {{ _('Please describe how you used the data.') }}
          </div>
        </div>

        <!-- Usage Idea - shown for "Idea" type -->
        <div id="usage_idea_field">
          {{ form.textarea('usage_idea', id='usage_idea',
          label=field_labels.usage_idea,
          placeholder=_('Describe your idea for how this dataset could be used...'),
          value=data.usage_idea, error=errors.usage_idea,
          attrs={'class': 'form-control'}, classes=['control-full']) }}
          <div class="invalid-feedback">
            {{ _('Please describe your idea for using the data.') }}
          </div>
        </div>

        <!-- Showcase Permission -->
        {{ form.select('showcase_permission', id='showcase_permission',
        label=field_labels.showcase_permission,
        options=showcase_permission_choices, selected=data.showcase_permission, error=errors.showcase_permission,
        classes=['control-full'], attrs={'required': 'required', 'class': 'form-control'}) }}

        <div class="control-group{% if errors.showcase_permission_other %} error{% endif %}" id="showcase_other_field"
          style="display: none;">
          {{ form.textarea('showcase_permission_other', id='showcase_permission_other',
          label=field_labels.showcase_permission_other, placeholder=_('Please specify your permission requirements'),
          value=data.showcase_permission_other,
          error=errors.showcase_permission_other, attrs={'class': 'form-control'},
          classes=['control-full']) }}
          <div class="invalid-feedback">
            {{ _('Please specify your permission requirements.') }}
          </div>
        </div>


        <!-- Additional Information -->
        {{ form.textarea('additional_information', id='additional_information',
        label=field_labels.additional_information,
        placeholder=_('Any additional information you would like to share...'), value=data.additional_information,
        error=errors.additional_information, attrs={'class': 'form-control'}, classes=['control-full'])
        }}

        <!-- Contact Permission -->
        {{ form.select('contact_permission', id='contact_permission', label=field_labels.contact_permission,
        options=contact_permission_choices, selected=data.contact_permission, error=errors.contact_permission,
        classes=['control-full'],
        attrs={'class': 'form-control'}) }}

        <!-- Submit Button -->
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">{{ _('Submit') }}</button>
          <a href="{{ h.url_for('dataset.read', id=package.name) }}" class="btn btn-default">{{ _('Cancel') }}</a>
        </div>
    </form>
  </div>
  </div>
</article>
{% endblock %}

{% block secondary_content %}
<aside class="module module-narrow module-shallow">
  <h2 class="module-heading">
    <i class="fa fa-info-circle"></i>
    {{ _('Help') }}
  </h2>
  <div class="module-content">
    <p class="small">{{ _('Share how you use this dataset to help others discover new applications.') }}</p>
    <ul>
      <li class="small">{{ _('Provide examples of how you have used this dataset in your work or projects.') }}</li>
      <li class="small">{{ _('Suggest potential uses if you have not used it yet.') }}</li>
    </ul>

    <p class="small text-muted">{{ _('Your submission may be showcased publicly.') }}</p>
  </div>
</aside>
{% endblock %}